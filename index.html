<!doctype html><html lang=en><meta charset=utf-8>
<title>shitcoins.wtf</title><script>
api = "https://api.coinmarketcap.com/v1"
pairs = "LTCBTC,XMRBTC,ETHBTC,MKRETH,MKRDAI", limit = 99, collapse = 99
oldstandard = "?pairs=LTCBTC,XMRBTC,ETHBTC,MKRETH,MKRDAI&limit=30&collapse=8"
if (location.search == oldstandard) location.search = ""
Object.keys(params).forEach(x => window[x] = params[x])
match = location.search.substring(1).split("&").map(x => x.split("="))
.filter(([n, v]) => Object.keys(params).includes(n))
.forEach(([n, v]) => window[n] = v)
</script><style>
@import url("https://fonts.googleapis.com/css?family=Fira+Mono");
html { font: 20pt/1.2 "Fira Mono", monospace; }
body { background: black; color: #999; margin: auto; }
a { color: inherit; }
table { border-collapse: collapse; width: 100%; }
td, th { padding: 0 .5rem; vertical-align: top; }
th { color: white; font-weight: normal; }
thead { font-weight: bold; }
thead .total { background: white; color: black; }
thead .banner, tfoot { background: blue; color: white; }
tr.collapse > * { border: none; }
tbody b { color: white }
.gray .change b { color: gray }
.red .change b { color: red }
.green .change b { color: #8f8 }
.star .price { background: blue; color: white; }
.star .price { border: .1rem solid blue }
.star .symbol { background: blue; color: white; font-weight: bold }
.star .symbol { border: .1rem solid blue }
</style><script>
_ = x => `${x.substr(0, x.length / 2)}_${x.substr(x.length / 2)}`
pairs = pairs.split(",").map(x => (/_/.test(x) ? x : _(x)).split("_"))
starred = x => [].concat(...pairs).includes(x.symbol)
classes = x => [x.symbol, redgreen(x), ...(starred(x) ? ["star"] : [])]
redgreen = x => redgreen100(x.percent_change_24h)
redgreen100 = x => Math.abs(Math.round(x)) < 1 ? "gray" : x < 0 ? "red" : "green"
percent = x => Math.round(x * 100) + "%"
order = x => Math.floor(Math.log10(x) / 3)
orders = ["p", "n", "&mu;", "m",, "k", "M", "B", "T"]
unit = x => order(x) ? orders[order(x) + 4] || "??" : ""
highlight = x => x.replace(/.+/, "<b>$&</b>")
num = x => highlight((x / Math.pow(10, order(x) * 3)).toFixed(2))
$ = x => cent(format(x).replace(/(?=\d)/, "$"))
cent = x => x.replace(/m<b>\$([\d.]+)/g, (m, n) => `<b>&cent;${$$(n / 10)}`)
$$ = x => x.toFixed(2)
format = x => cent(order(x) < 0 ? `${unit(x)}${num(x)}` : `${num(x)}${unit(x)}`)
formatshort = x => format(x).replace(/\D/g, "").substr(0, 2)
crop = (x, n) => x.length > n ? x.substr(0, n - 1) + "&hellip;" : x
coin = x => ticker.find(y => y.symbol == x)
share = x => percent(x.market_cap_usd / global.total_market_cap_usd)
onload = async () => { try {
  ticker = await (await fetch(`${api}/ticker/?limit=9999`)).json()
  global = await (await fetch(`${api}/global/`)).json()
  ticker.forEach((coin, i) => coin.rank = i + 1)
  ticker.filter(coin => starred(coin)).forEach(coin => {
    var delta = coin.rank > limit ? 0 : +collapse
    var min = Math.max(coin.rank - 1 - delta, 0)
    var max = Math.min(coin.rank - 1 + delta + 1, ticker.length)
    console.log(coin, delta, min, max, ticker.length)
    for (var i = min; i < max; i++) {
      ticker[i].visible = true
    }
  })
  for (var i = ticker.length - 1; i >= 0 && !ticker[i].visible; i--) {
    ticker[i].invisible = true
  }
  plusminus = x => String(x).replace(/^[^-]/, "+$&").replace(/^-/, "&minus;")
  percentchange = x => `<b>${plusminus(x)}%</b>/d`
  change = coin => percentchange(Math.round(coin.percent_change_24h))
  document.body.innerHTML = `<table>
<thead>
  <tr class=banner>
    <td align=right colspan=7>
      ${pairs.map(([x, y]) => `${x}${y}&nbsp;${formatshort(
        coin(x).price_usd / coin(y).price_usd
      )}`).join(" â”‚&zwj;&nbsp;")}
  <tr class=total>
    <td colspan=3 align=right> Total:
      ${$(global.total_market_cap_usd)}
    <td colspan=2 align=left>
      (${share(ticker[0])}&nbsp;${ticker[0].symbol},&nbsp;${
        share(ticker[1])}&nbsp;${ticker[1].symbol})
    <td colspan=2 align=right> Volume:
      ${$(global.total_24h_volume_usd)}/d</td>
<tbody> ${ticker.map(coin => collapse && coin.invisible ? "" :
collapse && !coin.visible ? "<tr class=collapse><td colspan=7> " : `
  <tr class="${classes(coin).join(" ")}">
    <td align=right> ${coin.rank}
    <th align=left>${coin.name}</th>
    <td align=right title="Total available supply: ${
      Number(coin.available_supply).toLocaleString()
    } ${coin.symbol}"> ${$(coin.market_cap_usd)}
    <td align=right class=symbol> ${crop(coin.symbol, 6)}
    <td align=right class=price> ${$(coin.price_usd)}${
      order(coin.price_usd) > 0 ? "" : "&nbsp;"}
    <td align=right class=change> ${change(coin)}
    <td align=right> ${$(coin["24h_volume_usd"])}/d
  `).join("")}
<tfoot>
  <td align=right colspan=7>
    via <a href=https://coinmarketcap.com>coinmarketcap.com</a>
`} catch (e) {
  document.body.style.padding = "2rem"
  document.body.innerHTML = `
    <b style="color: red">Error:</b> ${e.toString()}
    <p> Note: For some reason the CMC API is caught by ad blockers.
    <p><a href=https://www.google.com/search?q=coinmarketcap+api+ad+blocker>
      https://www.google.com/search?q=coinmarketcap+api+ad+blocker
    </a>
  `
} }</script>
