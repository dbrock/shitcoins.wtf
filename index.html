<!doctype html><html lang=en><meta charset=utf8>
<title>shitcoins.wtf</title><script>
api = "https://api.coinmarketcap.com/v1"
twitter = "https://api.twitter.com/1.1"
limit = 499, pairs = "BCHBTC,ETCETH,ZECBTC,MKRETH,ETHBTC"
match = location.search.substring(1).split("&").map(x => x.split("="))
.filter(([n, v]) => ["limit", "pairs"].includes(n))
.forEach(([n, v]) => window[n] = v)
</script><style>
html { font: 22pt/1 monospace; }
body { background: black; color: #999; }
body { max-width: 48rem; margin: auto; }
a { color: inherit; }
table { border-collapse: collapse; width: 100%; }
td, th { padding: 0 .5rem; vertical-align: top; }
th { color: white; font-weight: normal; }
thead { font-weight: bold; }
thead .total { background: white; color: black; }
thead .banner, tfoot { background: blue; color: white; }
tbody tr { border-bottom: .1rem solid #333; }
tbody b { color: white }
.red .change b { color: red }
.green .change b { color: #8f8 }
.star .price { background: blue; color: white; }
.star .price { border: .1rem solid blue }
.star .symbol { background: blue; color: white; font-weight: bold }
.star .symbol { border: .1rem solid blue }
</style><script>
pairs = pairs.split(",").map(x => (/_/.test(x) ? x :
  `${ x.substr(0, x.length / 2) }_${ x.substr(x.length / 2) }`
).split("_"))
starred = x => [].concat(...pairs).includes(x.symbol)
classes = x => [x.symbol, redgreen(x), ...(starred(x) ? ["star"] : [])]
redgreen = x => x.percent_change_24h < 0 ? "red" : "green"
percent = x => Math.round(x * 100) + "%"
order = x => Math.floor(Math.log10(x) / 3)
orders = ["p", "n", "&mu;", "m",, "k", "M", "B", "T"]
unit = x => order(x) ? orders[order(x) + 4] || "??" : ""
highlight = x => x.replace(/.+/, "<b>$&</b>")
num = x => highlight((x / Math.pow(10, order(x) * 3)).toFixed(2))
format = x => `${num(x)}${unit(x)}`
$ = x => order(x) < 0 ? `${unit(x)}$${num(x)}` : `$${format(x)}`
crop = (x, n) => x.length > n ? x.substr(0, n - 1) + "&hellip;" : x
coin = x => ticker.find(coin => coin.symbol == x)
share = x => percent(x.market_cap_usd / global.total_market_cap_usd)
onload = async () => { try {
ticker = await (await fetch(`${api}/ticker/?limit=${limit}`)).json()
global = await (await fetch(`${api}/global/`)).json()
mkr = (await (await fetch(`${api}/ticker/maker/`)).json())[0]
mkr.market_cap_usd = mkr.price_usd * mkr.total_supply
ticker = ticker.filter(coin => coin.symbol != "MKR")
mkr.rank = ticker.findIndex(coin => coin.market_cap_usd < mkr.market_cap_usd)
mkr.rank == -1 || ticker.splice(mkr.rank, 0, mkr)
ticker.forEach((coin, i) => coin.rank = i + 1)
plusminus = x => String(x).replace(/^[^-]/, "+$&").replace(/^-/, "&minus;")
change = coin => `<b>${ plusminus(Math.round(coin.percent_change_24h)) }%</b>/d`
document.body.innerHTML = `<table>
<thead>
  <tr class=banner>
    <td align=right colspan=7>
      ${ pairs.map(([x, y]) => `${x}${y}&nbsp;${
        format(coin(x).price_usd / coin(y).price_usd)
      }`).join(" â”‚ ") }
  <tr class=total>
    <td colspan=3 align=right> Total market cap:
      ${ $(global.total_market_cap_usd) }
    <td colspan=2 align=left>
      (${ share(ticker[0]) } ${ ticker[0].symbol },
       ${ share(ticker[1]) } ${ ticker[1].symbol })
    <td colspan=2 align=right> Total volume:
      ${ $(global.total_24h_volume_usd) }/d</td>
<tbody> ${ticker.map(coin => `
  <tr class="${ classes(coin).join(" ") }">
    <td align=right> ${ coin.rank }
    <th align=left> ${ crop(coin.name, 17) }
    <td align=right title="Total available supply: ${
      Number(coin.available_supply).toLocaleString()
    } ${ coin.symbol }"> ${ $(coin.market_cap_usd) }
    <td align=right class=symbol> ${ crop(coin.symbol, 6) }
    <td align=right class=price> ${ $(coin.price_usd) }${
      order(coin.price_usd) > 0 ? "" : "&nbsp;" }
    <td align=right class=change> ${ change(coin) }
    <td align=right> ${ $(coin["24h_volume_usd"]) }/d
  `).join("")}
<tfoot>
  <td align=right colspan=7>
    via <a href=https://coinmarketcap.com>coinmarketcap.com</a>
`} catch (e) { document.body.innerHTML = e.toString() }
}</script>
